"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[112],{25778:function(e,t,n){n.d(t,{W:function(){return D},j:function(){return C}});var r=n(34051),i=n.n(r),a=n(85893),o=n(41733),l=n(99226),u=n(81458),s=n(83321),c=n(15861),d=n(65362),f=n(26615),h=n(27798),p=n(67294),v=n(88767),m=n(62400),y=n(50122),b=n(9386),x=n(3430);function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function j(e,t,n,r,i,a,o){try{var l=e[a](o),u=l.value}catch(s){return void n(s)}l.done?t(u):Promise.resolve(u).then(r,i)}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){w(e,t,n[t])}))}return e}function Z(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){l=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(l)throw i}}return a}}(e,t)||A(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||A(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){if(e){if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}var C=function(e){var t=e.value,n=e.maxLength,r=void 0===n?200:n,i=O(p.useState(!1),2),o=i[0],u=i[1];return(0,a.jsxs)(l.Z,{children:[o?t:t.slice(0,r),"\xa0",t.length>r&&(0,a.jsx)(y.Z,{type:"button",component:"button",sx:{fontSize:"inherit"},onClick:function(){return u(!o)},children:o?"view less":"view more"})]})},D=function(e){var t,n=e.endpoint,r=e.columns,l=e.initialState,y=e.initialSorting,g=e.initialFilter,w=e.actions,A=Z(e,["endpoint","columns","initialState","initialSorting","initialFilter","actions"]),C=O(p.useState(null!==g&&void 0!==g?g:{items:[]}),2),D=C[0],k=C[1],E=O(p.useState(null!==y&&void 0!==y?y:[]),2),_=E[0],L=E[1],M=O(p.useState(null),2),I=M[0],N=M[1],F=(0,p.useMemo)((function(){var e=function(e){return[(0,a.jsx)(d.u,{icon:(0,a.jsx)(o.Z,{}),onClick:function(){return N(e.row)},label:"Delete"})]};return P(r).concat([{field:"actions",type:"actions",getActions:function(t){return P(w?w(t,e(t)):e(t))}}])}),[r]),T=(0,m.zy)(n,{},{}),W=T.isLoading,q=T.isFetching,U=T.data,R=T.count,G=T.page,Q=T.setPage,z=T.limit,B=T.setLimit,V=T.setQuery,H=T.setOrdering,$=(0,v.useMutation)(function(){var e,t=(e=i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("Deleting item ",t),e.next=3,m.x1.delete("".concat(n).concat(t.id));case 3:N(null);case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){j(a,r,i,o,l,"next",e)}function l(e){j(a,r,i,o,l,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}()),Y=$.isLoading,K=$.mutate;return(0,p.useEffect)((function(){var e=_.length?_:y,t="desc"===e[0].sort?"-":"",n=e[0].field;H("".concat(t).concat(n))}),[_,y]),(0,p.useEffect)((function(){var e,t;V(null!==(t=null===D||void 0===D||null===(e=D.quickFilterValues)||void 0===e?void 0:e.join(" "))&&void 0!==t?t:"")}),[D]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f._,S({},A,{rows:U||[],rowCount:R,loading:W||q,pagination:!0,page:G,pageSize:z,paginationMode:"server",onPageChange:Q,onPageSizeChange:B,columns:F,rowsPerPageOptions:[20,50,100],filterMode:"server",onFilterModelChange:k,sortingMode:"server",onSortModelChange:L,getRowHeight:function(){return"auto"},getEstimatedRowHeight:function(){return 100},components:{Toolbar:h.n,LoadingOverlay:u.Z},initialState:l,componentsProps:{toolbar:{showQuickFilter:!0,quickFilterProps:{debounceMs:500}}},sx:{"&.MuiDataGrid-root--densityCompact .MuiDataGrid-cell":{py:1,overflow:"hidden"},"&.MuiDataGrid-root--densityStandard .MuiDataGrid-cell":{py:"15px",overflow:"hidden"},"&.MuiDataGrid-root--densityComfortable .MuiDataGrid-cell":{py:"22px",overflow:"hidden"}}})),(0,a.jsx)(x.F,{title:"Do you really want to delete this dataset?",open:!!I,onClose:function(){return N(null)},children:(0,a.jsx)(b.Y,{actions:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.Z,{variant:"contained",color:"info",onClick:function(){return N(null)},children:"Cancel"}),(0,a.jsx)(s.Z,{variant:"contained",color:"error",onClick:function(){return K(I)},children:"Delete"})]}),loading:Y,children:(0,a.jsxs)(c.Z,{children:["Are you sure you want to delete item ",(0,a.jsx)("pre",{style:{display:"inline"},children:null!==(t=null===I||void 0===I?void 0:I.name)&&void 0!==t?t:null===I||void 0===I?void 0:I.title})]})})})]})}},87177:function(e,t,n){var r=n(73400),i=n(67294);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){l=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(l)throw i}}return a}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}t.Z=function(){var e=o(i.useState({message:void 0,variant:"default"}),2),t=e[0],n=e[1],a=(0,r.Ds)().enqueueSnackbar;return i.useEffect((function(){if(null===t||void 0===t?void 0:t.message){var e="info";t.variant&&(e=t.variant),a(t.message,{variant:e,autoHideDuration:5e3})}}),[t]),{notification:t,sendNotification:n}}},44112:function(e,t,n){n.r(t),n.d(t,{default:function(){return X}});var r=n(34051),i=n.n(r),a=n(85893),o=n(9008),l=n.n(o),u=n(99226),s=n(53156),c=n(66242),d=n(78445),f=n(83321),h=n(44267),p=n(67294),v=n(88767),m=n(76992),y=n(3430),b=n(45670),x=n(87462),g=n(63366),j=n(88409);const w=["children"];var S=p.forwardRef((function(e,t){const{children:n}=e,r=(0,g.Z)(e,w),i=(0,b._i)();if(null===i)throw new TypeError("No TabContext provided");const o=p.Children.map(n,(e=>p.isValidElement(e)?p.cloneElement(e,{"aria-controls":(0,b.uU)(i,e.props.value),id:(0,b.pQ)(i,e.props.value)}):null));return(0,a.jsx)(j.Z,(0,x.Z)({},r,{ref:t,value:i.value,children:o}))})),Z=n(55050),O=n(86886),P=n(61903),A=n(40044),C=n(94054),D=n(47312),k=n(85945),E=n(18972),_=n(82580),L=n(9386),M=n(87177),I=n(74231),N=n(62400),F=n(17224);function T(e,t,n,r,i,a,o){try{var l=e[a](o),u=l.value}catch(s){return void n(s)}l.done?t(u):Promise.resolve(u).then(r,i)}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){W(e,t,n[t])}))}return e}var U=function(e){var t=(0,p.useState)("existing"),n=t[0],r=t[1],o=(0,p.useState)(!1),l=o[0],s=o[1],c=(0,M.Z)().sendNotification,d=e.onClose,h=I.Ry({}),v=(0,_.TA)({initialValues:{name:"",description:"",database:"",source:"",sparql:"",search_mode:"LOCAL"},validationSchema:h,onSubmit:function(){var e,t=(e=i().mark((function e(t){var r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.prev=1,r="existing"===n?{source_type:"existing",database:t.database}:"urls"===n?{source_type:"urls",urls:t.source.split(/\r|\n/)}:{source_type:"sparql",sparql:t.sparql},e.next=5,N.x1.post("/datasets/",{name:t.name,description:t.description,source:r,search_mode:t.search_mode,mode:"sparql"===n?"SPARQL":"LOCAL"});case 5:(a=e.sent)&&(201===a.status?(c({variant:"success",message:"Dataset scheduled for creation"}),d(!0)):c({variant:"error",message:"Error creating dataset"})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0),c({variant:"error",message:"Error creating dataset"});case 13:s(!1);case 14:case"end":return e.stop()}}),e,null,[[1,9]])})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){T(a,r,i,o,l,"next",e)}function l(e){T(a,r,i,o,l,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}()});return(0,a.jsx)(L.Y,{form:v,loading:l,actions:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(f.Z,{variant:"contained",type:"submit",children:"Submit"})}),children:(0,a.jsxs)(O.ZP,{container:!0,spacing:3,children:[(0,a.jsx)(O.ZP,{item:!0,xs:12,children:(0,a.jsx)(P.Z,q({label:"Name",variant:"outlined",fullWidth:!0},(0,F.s)(v,"name")))}),(0,a.jsx)(O.ZP,{item:!0,xs:12,children:(0,a.jsx)(P.Z,q({label:"Description",variant:"outlined",multiline:!0,fullWidth:!0},(0,F.s)(v,"description")))}),(0,a.jsx)(O.ZP,{item:!0,xs:12,children:(0,a.jsxs)(b.ZP,{value:n,children:[(0,a.jsx)(u.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,a.jsxs)(S,{onChange:function(e,t){return r(t)},centered:!0,children:[(0,a.jsx)(A.Z,{label:"Existing",value:"existing"}),(0,a.jsx)(A.Z,{label:"Import URL(s)",value:"url"}),(0,a.jsx)(A.Z,{label:"SPARQL Endpoint",value:"sparql"})]})}),(0,a.jsx)(Z.Z,{value:"existing",children:(0,a.jsx)(O.ZP,{container:!0,spacing:3,children:(0,a.jsx)(O.ZP,{item:!0,xs:12,children:(0,a.jsx)(P.Z,q({label:"Database",variant:"outlined",fullWidth:!0},(0,F.s)(v,"database")))})})}),(0,a.jsx)(Z.Z,{value:"url",children:(0,a.jsx)(O.ZP,{container:!0,spacing:3,children:(0,a.jsx)(O.ZP,{item:!0,xs:12,children:(0,a.jsx)(P.Z,q({label:"URL(s) to dataset",placeholder:"Urls separated by newline",variant:"outlined",multiline:!0,rows:3,fullWidth:!0},(0,F.s)(v,"source")))})})}),(0,a.jsx)(Z.Z,{value:"sparql",children:(0,a.jsx)(O.ZP,{item:!0,xs:12,children:(0,a.jsx)(P.Z,q({label:"SPARQL Endpoint URL",variant:"outlined",fullWidth:!0},(0,F.s)(v,"sparql")))})})]})}),(0,a.jsx)(O.ZP,{item:!0,xs:12,children:(0,a.jsxs)(C.Z,{fullWidth:!0,children:[(0,a.jsx)(D.Z,{id:"search_mode_label",children:"Search Mode"}),(0,a.jsxs)(k.Z,q({labelId:"search_mode_label",label:"Search Mode"},(0,F.s)(v,"search_mode"),{children:[(0,a.jsx)(E.Z,{value:"LOCAL",children:"Build Local Search Index"}),(0,a.jsx)(E.Z,{value:"WIKIDATA",children:"Use WikiData API"})]}))]})})]})})},R=n(25778),G=n(93902);function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var z=[{field:"id",headerName:"ID",flex:.5,valueFormatter:function(e){return(0,G.UN)(e.value)}},{field:"name",headerName:"Name",flex:1},{field:"description",headerName:"Description",flex:1,renderCell:function(e){return(0,a.jsx)(R.j,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Q(e,t,n[t])}))}return e}({},e,{maxLength:100}))}},{field:"database",headerName:"Database",flex:.5},{field:"state",headerName:"State",flex:.5,type:"singleSelect"},{field:"triples",headerName:"Triples",flex:.5,type:"number",valueGetter:function(e){var t;return null===(t=e.row.statistics)||void 0===t?void 0:t.triple_count}},{field:"created_at",headerName:"Created At",flex:.5,type:"dateTime",minWidth:200,valueFormatter:function(e){return(0,G.o0)(e.value)}},{field:"updated_at",headerName:"Updated At",flex:.5,type:"dateTime",minWidth:200,valueFormatter:function(e){return(0,G.o0)(e.value)}}],B={columns:{columnVisibilityModel:{database:!0,updated_at:!1}}},V=[{field:"created_at",sort:"desc"}],H=function(e){return(0,a.jsx)(u.Z,{sx:{width:"100%",height:600},children:(0,a.jsx)(R.W,{endpoint:"/datasets/",columns:z,initialState:B,initialSorting:V})})};function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Y(e,t,n,r,i,a,o){try{var l=e[a](o),u=l.value}catch(s){return void n(s)}l.done?t(u):Promise.resolve(u).then(r,i)}function K(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){l=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(l)throw i}}return a}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return $(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var J=function(){var e=(0,v.useQueryClient)(),t=K(p.useState(!1),2),n=t[0],r=t[1];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l(),{children:(0,a.jsx)("title",{children:"BOLD Datasets"})}),(0,a.jsx)(u.Z,{component:"main",sx:{flexGrow:1,py:8},children:(0,a.jsx)(s.Z,{maxWidth:!1,children:(0,a.jsxs)(c.Z,{children:[(0,a.jsx)(d.Z,{title:"Datasets",action:(0,a.jsx)(f.Z,{variant:"contained",onClick:function(){return r(!0)},children:"Create Dataset"})}),(0,a.jsx)(h.Z,{children:(0,a.jsx)(H,{})})]})})}),(0,a.jsx)(y.F,{title:"Create Dataset",open:n,onClose:function(){return r(!1)},children:(0,a.jsx)(U,{onClose:function(){var t,n=(t=i().mark((function t(n){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r(!1),!n){t.next=4;break}return t.next=4,e.invalidateQueries("/datasets/");case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(e){Y(a,r,i,o,l,"next",e)}function l(e){Y(a,r,i,o,l,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}()})})]})};J.getLayout=function(e){return(0,a.jsx)(m.A,{showNavbar:!1,children:e})};var X=J},17224:function(e,t,n){n.d(t,{s:function(){return r}});var r=function(e,t){return{name:t,value:e.values[t],onChange:e.handleChange,error:e.touched[t]&&Boolean(e.errors[t]),helperText:e.touched[t]&&e.errors[t]}}}}]);